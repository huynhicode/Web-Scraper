{"ast":null,"code":"// Next.js API route support: https://nextjs.org/docs/api-routes/introduction\nimport axios from \"axios\";\n\nfunction scrape(req, res) {\n  if (req.method === \"POST\") {\n    const {\n      urls\n    } = req.body;\n    const urlArray = urls.split(\",\").map(rawUrl => {\n      const url = rawUrl.trim();\n\n      if (url.startsWith(\"http\")) {\n        return url;\n      }\n\n      return \"https://\".concat(url);\n    });\n    const promiseArray = urlArray.map(url => axios(url));\n    Promise.allSettled(promiseArray).then(results => {\n      const formattedResponse = results.map((response, index) => {\n        var _response$value, _response$reason;\n\n        return console.log({\n          status: response.status,\n          valueKeys: Object.keys(response.value || {}),\n          reason: response.reason\n        }) || {\n          url: urlArray[index],\n          html: (_response$value = response.value) === null || _response$value === void 0 ? void 0 : _response$value.data,\n          error: (_response$reason = response.reason) === null || _response$reason === void 0 ? void 0 : _response$reason.message\n        };\n      });\n      res.status(200).json(formattedResponse);\n    });\n  }\n}\n\nexport default scrape;","map":{"version":3,"sources":["/Users/steph/Desktop/coding-challenge/pages/api/scrape.js"],"names":["axios","scrape","req","res","method","urls","body","urlArray","split","map","rawUrl","url","trim","startsWith","concat","promiseArray","Promise","allSettled","then","results","formattedResponse","response","index","console","log","status","valueKeys","Object","keys","value","reason","html","data","error","message","json"],"mappings":"AAAA;AACA,OAAOA,KAAP,MAAkB,OAAlB;;AAEA,SAASC,MAAT,CAAgBC,GAAhB,EAAqBC,GAArB,EAA0B;AACxB,MAAID,GAAG,CAACE,MAAJ,KAAe,MAAnB,EAA2B;AACzB,UAAM;AAAEC,MAAAA;AAAF,QAAWH,GAAG,CAACI,IAArB;AAEA,UAAMC,QAAQ,GAAGF,IAAI,CAACG,KAAL,CAAW,GAAX,EAAgBC,GAAhB,CAAqBC,MAAD,IAAY;AAC/C,YAAMC,GAAG,GAAGD,MAAM,CAACE,IAAP,EAAZ;;AACA,UAAID,GAAG,CAACE,UAAJ,CAAe,MAAf,CAAJ,EAA4B;AAC1B,eAAOF,GAAP;AACD;;AACD,aAAO,WAAWG,MAAX,CAAkBH,GAAlB,CAAP;AACD,KANgB,CAAjB;AAQA,UAAMI,YAAY,GAAGR,QAAQ,CAACE,GAAT,CAAcE,GAAD,IAASX,KAAK,CAACW,GAAD,CAA3B,CAArB;AAEAK,IAAAA,OAAO,CAACC,UAAR,CAAmBF,YAAnB,EAAiCG,IAAjC,CAAuCC,OAAD,IAAa;AACjD,YAAMC,iBAAiB,GAAGD,OAAO,CAACV,GAAR,CACxB,CAACY,QAAD,EAAWC,KAAX;AAAA;;AAAA,eACEC,OAAO,CAACC,GAAR,CAAY;AACVC,UAAAA,MAAM,EAAEJ,QAAQ,CAACI,MADP;AAEVC,UAAAA,SAAS,EAAEC,MAAM,CAACC,IAAP,CAAYP,QAAQ,CAACQ,KAAT,IAAkB,EAA9B,CAFD;AAGVC,UAAAA,MAAM,EAAET,QAAQ,CAACS;AAHP,SAAZ,KAIM;AACJnB,UAAAA,GAAG,EAAEJ,QAAQ,CAACe,KAAD,CADT;AAEJS,UAAAA,IAAI,qBAAEV,QAAQ,CAACQ,KAAX,oDAAE,gBAAgBG,IAFlB;AAGJC,UAAAA,KAAK,sBAAEZ,QAAQ,CAACS,MAAX,qDAAE,iBAAiBI;AAHpB,SALR;AAAA,OADwB,CAA1B;AAYA/B,MAAAA,GAAG,CAACsB,MAAJ,CAAW,GAAX,EAAgBU,IAAhB,CAAqBf,iBAArB;AACD,KAdD;AAeD;AACF;;AAED,eAAenB,MAAf","sourcesContent":["// Next.js API route support: https://nextjs.org/docs/api-routes/introduction\nimport axios from \"axios\";\n\nfunction scrape(req, res) {\n  if (req.method === \"POST\") {\n    const { urls } = req.body;\n\n    const urlArray = urls.split(\",\").map((rawUrl) => {\n      const url = rawUrl.trim();\n      if (url.startsWith(\"http\")) {\n        return url;\n      }\n      return \"https://\".concat(url);\n    });\n\n    const promiseArray = urlArray.map((url) => axios(url));\n\n    Promise.allSettled(promiseArray).then((results) => {\n      const formattedResponse = results.map(\n        (response, index) =>\n          console.log({\n            status: response.status,\n            valueKeys: Object.keys(response.value || {}),\n            reason: response.reason,\n          }) || {\n            url: urlArray[index],\n            html: response.value?.data,\n            error: response.reason?.message,\n          }\n      );\n      res.status(200).json(formattedResponse);\n    });\n  }\n}\n\nexport default scrape;\n"]},"metadata":{},"sourceType":"module"}